[{"sha":"4a2296d4ee94c5b9d63d898d9733f1c9f0bc0192","node_id":"MDY6Q29tbWl0MzM5ODIyNDAyOjRhMjI5NmQ0ZWU5NGM1YjlkNjNkODk4ZDk3MzNmMWM5ZjBiYzAxOTI=","commit":{"author":{"name":"Jason Nichols","email":"jason@kickroot.com","date":"2021-07-01T13:21:02Z"},"committer":{"name":"GitHub","email":"noreply@github.com","date":"2021-07-01T13:21:02Z"},"message":"Merge CSPM into Main (#168)\n\n* Defining interfaces for development\r\n\r\n* Distribution Packaging\r\n\r\n* small log rename\r\n\r\n* Policy->CLi\r\n\r\n* Cpsm policy acquistion (#110)\r\n\r\n* PolicyAcquisition\r\n\r\n* ~ marker resolution\r\n\r\n* Fix\r\n\r\n* Listing policies\r\n\r\n* Listing policies - fix\r\n\r\n* PolicyAcquisition improvements\r\n\r\n* PolicyAcquisition improvements - fix\r\n\r\n* Refactored rules loading\r\n\r\n* Minor foreach refactor\r\n\r\n* Now getting the repository hash to metadata\r\n\r\n* Rules loading refactor for clearer code\r\n\r\n* Improvement in code clarity for getting repoHash function\r\n\r\n* Changed default config repository to git@github.com:openraven/aws-cis-1.2.git\r\n\r\n* Review issues fix\r\n\r\n* Implement PolicyAnalyzerService\r\n\r\n* Implement ReportService\r\n\r\n* Implement Python Evaluator\r\n\r\n* Run analyzer\r\n\r\n* Human readable output\r\n\r\n* Accounts discovery null value fix (#115)\r\n\r\n* Discovery accounts \"The security token included in the request\" not handled properly\r\n\r\n* Uncommented some working code and small rename of fucntion\r\n\r\n* Bold section headlines\r\n\r\n* passwordPolicy casing fix (#121)\r\n\r\n* Discover all policies, not just Local scoped\r\n\r\n* Cspm repository path extension (#118)\r\n\r\n* Policy Path Collision\r\n\r\n* Refactor\r\n\r\n* Now operation on Map abstraction in rulesMap\r\n\r\n* Decode policy document\r\n\r\n* Added config discovery (#128)\r\n\r\n* Added config discovery\r\n\r\n* RESOURCE_TYPE improvment\r\n\r\n* Add CloudWatchLogsDiscovery\r\n\r\n* Address PR comment: Use correct client\r\n\r\n* Comment ARN\r\n\r\n* Add manualControl field and logic\r\n\r\n* Output stderr only if it's not empty\r\n\r\n* Trim values to fit the columns\r\n\r\n* Discover VPC's FlowLogs\r\n\r\n* Check for missing tables, capture the table name via regex and report via logger (#142)\r\n\r\nCo-authored-by: Jason Nichols <jason@openraven.com>\r\n\r\n* Trim first X characters of resource ID to fit the column\r\n\r\n* Docker updates to handle CSPM functions (#145)\r\n\r\n* Initial conditionals\r\n\r\n* Refactored the Docker setup to work with both magpie-discovery and magpie-policy\r\n\r\n* Use the https based url by default instead, remove the test repo that snuck in by default\r\n\r\n* Add a warning log message when an AWS plugin service won't scan because no supported regions are configured\r\n\r\n* Update docker tags and branches.  We'll use magpie-cspm in the short term until we merge magpie-csmp into main\r\n\r\n* Let's get a test docker build running prior to merge\r\n\r\n* Let's get a test docker build running prior to merge to main\r\n\r\nCo-authored-by: Jason Nichols <jason@openraven.com>\r\n\r\n* Updated GH action to build docker image\r\n\r\n* Check if Policy/Rule enabled\r\n\r\n* Print policy status\r\nDon't print columns if there are no violations\r\n\r\n* Address PR comment\r\n\r\n* Defined new ReportService interface\r\n\r\n* Moved ignored rules to PolicyContext for easier organization\r\n\r\n* Use ScanResult\r\n\r\n* Print plain text reason\r\nFix printing ignored rules when all rules are ignored\r\n\r\n* Fix numOfViolations increment\r\n\r\n* Update analyzer to use asset_id\r\n\r\n* Check for missing assets\r\n\r\nBefore analyzing the rule, check whether all assets\r\nneeded by rule exist in the assets table\r\n\r\n* Improved persistence (#164)\r\n\r\n* Use latest api snapshot\r\n\r\n* Improved persistance aws (#154)\r\n\r\n* Utilized new builder for MagpieResource\r\n\r\n* Removed code artifact\r\n\r\n* Revert \"Removed code artifact\"\r\n\r\nThis reverts commit b0caf921\r\n\r\n* Use release version of magpie-api\r\n\r\n* Allow builds on improved_persistance branch\r\n\r\n* Version update\r\n\r\n* Fixed some unintentional changes\r\n\r\nCo-authored-by: Jason Nichols <jason@openraven.com>\r\n\r\n* Fix S3Discovery\r\n\r\n* Fix  exceptions\r\n\r\n* Integration with Flyway for proper schema preparation in scope of PersistPlugin execution\r\n\r\n* More fixes\r\n\r\n* Refactoring persist plugin integration with Flyway\r\n\r\n* Fix tests\r\n\r\n* Fix build failure\r\n\r\n* Fix discoverPolicies test\r\n\r\n* Remove account summary check\r\n\r\n* Add account summary discovery and test\r\n\r\nCo-authored-by: Jason Nichols <jason@openraven.com>\r\nCo-authored-by: PrzemyslawTusinski <tusinski.t@gmail.com>\r\nCo-authored-by: Stefan Markovic <stefan@janeasystems.com>\r\nCo-authored-by: Stefan Markovic <57057282+stefansjfw@users.noreply.github.com>\r\nCo-authored-by: mbiloshytskyi <belosh59@gmail.com>\r\n\r\n* Use normalized rules\r\n\r\n* Output Formatting Tweaks\r\n\r\nCo-authored-by: Jason Nichols <jason@openraven.com>\r\nCo-authored-by: Przemysław Tusiński <tusinski.t@gmail.com>\r\nCo-authored-by: Stefan Markovic <stefan@janeasystems.com>\r\nCo-authored-by: Stefan Markovic <57057282+stefansjfw@users.noreply.github.com>\r\nCo-authored-by: mbiloshytskyi <belosh59@gmail.com>","tree":{"sha":"e95ab8a8243a76194b52535188591c836e83e662","url":"https://api.github.com/repos/openraven/magpie/git/trees/e95ab8a8243a76194b52535188591c836e83e662"},"url":"https://api.github.com/repos/openraven/magpie/git/commits/4a2296d4ee94c5b9d63d898d9733f1c9f0bc0192","comment_count":0,"verification":{"verified":true,"reason":"valid","signature":"-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJg3cE+CRBK7hj4Ov3rIwAABdAIAB78Y02zRXZOlbCfh+D2JxJE\n3KODkYbfKorNvA1YSst0MhIirqe/Ut132SB2XMyzvwmzcmD7zAqC3Beip/tIm+WB\nBzUluj2Eeu6cZwQeLBRlXrvox6nU9dZ251Dqo4CCdRHuMldAnrjY1Fd7gffz2gJt\nXPpQvIdmyBNHpQTf2faP11va5W5/70hTCfgEHVwZPERnCfHPYN4lisujxtCuiacB\nlPW879Xw91QMtYniR8UjoX2MrvgnqCEus9oGZGAbzqc/BZUYmMKo+hxnGTGXDxD5\n+JsCY9NyZvGgNumFuSHD5lQ6IsDG0oWXit+ZpXT9zUNvoe2ORHvlrEDEujddKn4=\n=rqXZ\n-----END PGP SIGNATURE-----\n","payload":"tree e95ab8a8243a76194b52535188591c836e83e662\nparent 8642cad7c87fdf4ab0c4dbb83b7e774f09ed089f\nauthor Jason Nichols <jason@kickroot.com> 1625145662 -0400\ncommitter GitHub <noreply@github.com> 1625145662 -0400\n\nMerge CSPM into Main (#168)\n\n* Defining interfaces for development\r\n\r\n* Distribution Packaging\r\n\r\n* small log rename\r\n\r\n* Policy->CLi\r\n\r\n* Cpsm policy acquistion (#110)\r\n\r\n* PolicyAcquisition\r\n\r\n* ~ marker resolution\r\n\r\n* Fix\r\n\r\n* Listing policies\r\n\r\n* Listing policies - fix\r\n\r\n* PolicyAcquisition improvements\r\n\r\n* PolicyAcquisition improvements - fix\r\n\r\n* Refactored rules loading\r\n\r\n* Minor foreach refactor\r\n\r\n* Now getting the repository hash to metadata\r\n\r\n* Rules loading refactor for clearer code\r\n\r\n* Improvement in code clarity for getting repoHash function\r\n\r\n* Changed default config repository to git@github.com:openraven/aws-cis-1.2.git\r\n\r\n* Review issues fix\r\n\r\n* Implement PolicyAnalyzerService\r\n\r\n* Implement ReportService\r\n\r\n* Implement Python Evaluator\r\n\r\n* Run analyzer\r\n\r\n* Human readable output\r\n\r\n* Accounts discovery null value fix (#115)\r\n\r\n* Discovery accounts \"The security token included in the request\" not handled properly\r\n\r\n* Uncommented some working code and small rename of fucntion\r\n\r\n* Bold section headlines\r\n\r\n* passwordPolicy casing fix (#121)\r\n\r\n* Discover all policies, not just Local scoped\r\n\r\n* Cspm repository path extension (#118)\r\n\r\n* Policy Path Collision\r\n\r\n* Refactor\r\n\r\n* Now operation on Map abstraction in rulesMap\r\n\r\n* Decode policy document\r\n\r\n* Added config discovery (#128)\r\n\r\n* Added config discovery\r\n\r\n* RESOURCE_TYPE improvment\r\n\r\n* Add CloudWatchLogsDiscovery\r\n\r\n* Address PR comment: Use correct client\r\n\r\n* Comment ARN\r\n\r\n* Add manualControl field and logic\r\n\r\n* Output stderr only if it's not empty\r\n\r\n* Trim values to fit the columns\r\n\r\n* Discover VPC's FlowLogs\r\n\r\n* Check for missing tables, capture the table name via regex and report via logger (#142)\r\n\r\nCo-authored-by: Jason Nichols <jason@openraven.com>\r\n\r\n* Trim first X characters of resource ID to fit the column\r\n\r\n* Docker updates to handle CSPM functions (#145)\r\n\r\n* Initial conditionals\r\n\r\n* Refactored the Docker setup to work with both magpie-discovery and magpie-policy\r\n\r\n* Use the https based url by default instead, remove the test repo that snuck in by default\r\n\r\n* Add a warning log message when an AWS plugin service won't scan because no supported regions are configured\r\n\r\n* Update docker tags and branches.  We'll use magpie-cspm in the short term until we merge magpie-csmp into main\r\n\r\n* Let's get a test docker build running prior to merge\r\n\r\n* Let's get a test docker build running prior to merge to main\r\n\r\nCo-authored-by: Jason Nichols <jason@openraven.com>\r\n\r\n* Updated GH action to build docker image\r\n\r\n* Check if Policy/Rule enabled\r\n\r\n* Print policy status\r\nDon't print columns if there are no violations\r\n\r\n* Address PR comment\r\n\r\n* Defined new ReportService interface\r\n\r\n* Moved ignored rules to PolicyContext for easier organization\r\n\r\n* Use ScanResult\r\n\r\n* Print plain text reason\r\nFix printing ignored rules when all rules are ignored\r\n\r\n* Fix numOfViolations increment\r\n\r\n* Update analyzer to use asset_id\r\n\r\n* Check for missing assets\r\n\r\nBefore analyzing the rule, check whether all assets\r\nneeded by rule exist in the assets table\r\n\r\n* Improved persistence (#164)\r\n\r\n* Use latest api snapshot\r\n\r\n* Improved persistance aws (#154)\r\n\r\n* Utilized new builder for MagpieResource\r\n\r\n* Removed code artifact\r\n\r\n* Revert \"Removed code artifact\"\r\n\r\nThis reverts commit b0caf921\r\n\r\n* Use release version of magpie-api\r\n\r\n* Allow builds on improved_persistance branch\r\n\r\n* Version update\r\n\r\n* Fixed some unintentional changes\r\n\r\nCo-authored-by: Jason Nichols <jason@openraven.com>\r\n\r\n* Fix S3Discovery\r\n\r\n* Fix  exceptions\r\n\r\n* Integration with Flyway for proper schema preparation in scope of PersistPlugin execution\r\n\r\n* More fixes\r\n\r\n* Refactoring persist plugin integration with Flyway\r\n\r\n* Fix tests\r\n\r\n* Fix build failure\r\n\r\n* Fix discoverPolicies test\r\n\r\n* Remove account summary check\r\n\r\n* Add account summary discovery and test\r\n\r\nCo-authored-by: Jason Nichols <jason@openraven.com>\r\nCo-authored-by: PrzemyslawTusinski <tusinski.t@gmail.com>\r\nCo-authored-by: Stefan Markovic <stefan@janeasystems.com>\r\nCo-authored-by: Stefan Markovic <57057282+stefansjfw@users.noreply.github.com>\r\nCo-authored-by: mbiloshytskyi <belosh59@gmail.com>\r\n\r\n* Use normalized rules\r\n\r\n* Output Formatting Tweaks\r\n\r\nCo-authored-by: Jason Nichols <jason@openraven.com>\r\nCo-authored-by: Przemysław Tusiński <tusinski.t@gmail.com>\r\nCo-authored-by: Stefan Markovic <stefan@janeasystems.com>\r\nCo-authored-by: Stefan Markovic <57057282+stefansjfw@users.noreply.github.com>\r\nCo-authored-by: mbiloshytskyi <belosh59@gmail.com>"}},"url":"https://api.github.com/repos/openraven/magpie/commits/4a2296d4ee94c5b9d63d898d9733f1c9f0bc0192","html_url":"https://github.com/openraven/magpie/commit/4a2296d4ee94c5b9d63d898d9733f1c9f0bc0192","comments_url":"https://api.github.com/repos/openraven/magpie/commits/4a2296d4ee94c5b9d63d898d9733f1c9f0bc0192/comments","author":{"login":"kickroot","id":1015101,"node_id":"MDQ6VXNlcjEwMTUxMDE=","avatar_url":"https://avatars.githubusercontent.com/u/1015101?v=4","gravatar_id":"","url":"https://api.github.com/users/kickroot","html_url":"https://github.com/kickroot","followers_url":"https://api.github.com/users/kickroot/followers","following_url":"https://api.github.com/users/kickroot/following{/other_user}","gists_url":"https://api.github.com/users/kickroot/gists{/gist_id}","starred_url":"https://api.github.com/users/kickroot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kickroot/subscriptions","organizations_url":"https://api.github.com/users/kickroot/orgs","repos_url":"https://api.github.com/users/kickroot/repos","events_url":"https://api.github.com/users/kickroot/events{/privacy}","received_events_url":"https://api.github.com/users/kickroot/received_events","type":"User","site_admin":false},"committer":{"login":"web-flow","id":19864447,"node_id":"MDQ6VXNlcjE5ODY0NDQ3","avatar_url":"https://avatars.githubusercontent.com/u/19864447?v=4","gravatar_id":"","url":"https://api.github.com/users/web-flow","html_url":"https://github.com/web-flow","followers_url":"https://api.github.com/users/web-flow/followers","following_url":"https://api.github.com/users/web-flow/following{/other_user}","gists_url":"https://api.github.com/users/web-flow/gists{/gist_id}","starred_url":"https://api.github.com/users/web-flow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/web-flow/subscriptions","organizations_url":"https://api.github.com/users/web-flow/orgs","repos_url":"https://api.github.com/users/web-flow/repos","events_url":"https://api.github.com/users/web-flow/events{/privacy}","received_events_url":"https://api.github.com/users/web-flow/received_events","type":"User","site_admin":false},"parents":[{"sha":"8642cad7c87fdf4ab0c4dbb83b7e774f09ed089f","url":"https://api.github.com/repos/openraven/magpie/commits/8642cad7c87fdf4ab0c4dbb83b7e774f09ed089f","html_url":"https://github.com/openraven/magpie/commit/8642cad7c87fdf4ab0c4dbb83b7e774f09ed089f"}]}]