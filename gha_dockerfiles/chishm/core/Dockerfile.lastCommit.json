[{"sha":"54064b4010369b85307f76bb0bdf26e8a9e21a0c","node_id":"MDY6Q29tbWl0MzUxMDY5ODQzOjU0MDY0YjQwMTAzNjliODUzMDdmNzZiYjBiZGYyNmU4YTllMjFhMGM=","commit":{"author":{"name":"Stefan Agner","email":"stefan@agner.ch","date":"2021-01-11T10:24:02Z"},"committer":{"name":"GitHub","email":"noreply@github.com","date":"2021-01-11T10:24:02Z"},"message":"Increase timeout to avoid killing the core during shutdown (#45029)\n\nStopping the core goes through several stages, which can take up to\r\n120s, 60s and 30s respectively. However, if shutdown is taking longer\r\nthan 60s overall, s6 isn't patient and kills the core:\r\nJan 10 23:56:58 homeassistant eb034fca9c7d[407]: s6-svwait: fatal: timed out\r\nJan 10 23:56:58 homeassistant eb034fca9c7d[407]: [s6-finish] sending all processes the TERM signal.\r\nJan 10 23:57:01 homeassistant eb034fca9c7d[407]: [s6-finish] sending all processes the KILL signal and exiting.\r\n\r\nThis is most of the time not a problem since shutdown is quicker than\r\nthat.\r\n\r\nHowever, increasing the timeout is especialy useful to debug cases when\r\nan event is hanging, since the core will point it out after its timeout\r\nelapsed.\r\n\r\nSet the timeout to 220s, which is all core timeouts plus 10s grace time.","tree":{"sha":"377ed9a1e31c228370602ebc890441cb6f170824","url":"https://api.github.com/repos/chishm/core/git/trees/377ed9a1e31c228370602ebc890441cb6f170824"},"url":"https://api.github.com/repos/chishm/core/git/commits/54064b4010369b85307f76bb0bdf26e8a9e21a0c","comment_count":0,"verification":{"verified":true,"reason":"valid","signature":"-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJf/CdCCRBK7hj4Ov3rIwAAdHIIABGgg3b7h7+nXAe94QzCjd6C\nmTmV41Cpu/pVZ8JWw+whNYgaKM+//7Pj+eUHyWxjhDaBUtm/cAHs4zD/NIYvSRKN\nJTODIBT0HkrP9UlWWZVJpHaoPhfm4wS1mKDFOI6Uo7CyjNtaHAN4i/OOMsPVJsYM\nbdD0pm+VVjochCPzyB75By5t8WYMEuyxK/684hzNW7Es6gnmE4kokPAFxc9+PZXS\ns35vONleki2ONzRwQKDrjTpgRL/R2OupreI3qGXe9aIKXlkzKjOr6r92MfwTn0LO\nMM8uzzsd/xr3o5WbfazMy9goF6mM+1n8LxcEaW2W5bQerxjlu5GN0brDn6WfDe4=\n=48Fi\n-----END PGP SIGNATURE-----\n","payload":"tree 377ed9a1e31c228370602ebc890441cb6f170824\nparent ab25c5a2bdb010fc9ae68bdc0eb5a96dc461e46d\nauthor Stefan Agner <stefan@agner.ch> 1610360642 +0100\ncommitter GitHub <noreply@github.com> 1610360642 +0100\n\nIncrease timeout to avoid killing the core during shutdown (#45029)\n\nStopping the core goes through several stages, which can take up to\r\n120s, 60s and 30s respectively. However, if shutdown is taking longer\r\nthan 60s overall, s6 isn't patient and kills the core:\r\nJan 10 23:56:58 homeassistant eb034fca9c7d[407]: s6-svwait: fatal: timed out\r\nJan 10 23:56:58 homeassistant eb034fca9c7d[407]: [s6-finish] sending all processes the TERM signal.\r\nJan 10 23:57:01 homeassistant eb034fca9c7d[407]: [s6-finish] sending all processes the KILL signal and exiting.\r\n\r\nThis is most of the time not a problem since shutdown is quicker than\r\nthat.\r\n\r\nHowever, increasing the timeout is especialy useful to debug cases when\r\nan event is hanging, since the core will point it out after its timeout\r\nelapsed.\r\n\r\nSet the timeout to 220s, which is all core timeouts plus 10s grace time."}},"url":"https://api.github.com/repos/chishm/core/commits/54064b4010369b85307f76bb0bdf26e8a9e21a0c","html_url":"https://github.com/chishm/core/commit/54064b4010369b85307f76bb0bdf26e8a9e21a0c","comments_url":"https://api.github.com/repos/chishm/core/commits/54064b4010369b85307f76bb0bdf26e8a9e21a0c/comments","author":{"login":"agners","id":34061,"node_id":"MDQ6VXNlcjM0MDYx","avatar_url":"https://avatars.githubusercontent.com/u/34061?v=4","gravatar_id":"","url":"https://api.github.com/users/agners","html_url":"https://github.com/agners","followers_url":"https://api.github.com/users/agners/followers","following_url":"https://api.github.com/users/agners/following{/other_user}","gists_url":"https://api.github.com/users/agners/gists{/gist_id}","starred_url":"https://api.github.com/users/agners/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/agners/subscriptions","organizations_url":"https://api.github.com/users/agners/orgs","repos_url":"https://api.github.com/users/agners/repos","events_url":"https://api.github.com/users/agners/events{/privacy}","received_events_url":"https://api.github.com/users/agners/received_events","type":"User","site_admin":false},"committer":{"login":"web-flow","id":19864447,"node_id":"MDQ6VXNlcjE5ODY0NDQ3","avatar_url":"https://avatars.githubusercontent.com/u/19864447?v=4","gravatar_id":"","url":"https://api.github.com/users/web-flow","html_url":"https://github.com/web-flow","followers_url":"https://api.github.com/users/web-flow/followers","following_url":"https://api.github.com/users/web-flow/following{/other_user}","gists_url":"https://api.github.com/users/web-flow/gists{/gist_id}","starred_url":"https://api.github.com/users/web-flow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/web-flow/subscriptions","organizations_url":"https://api.github.com/users/web-flow/orgs","repos_url":"https://api.github.com/users/web-flow/repos","events_url":"https://api.github.com/users/web-flow/events{/privacy}","received_events_url":"https://api.github.com/users/web-flow/received_events","type":"User","site_admin":false},"parents":[{"sha":"ab25c5a2bdb010fc9ae68bdc0eb5a96dc461e46d","url":"https://api.github.com/repos/chishm/core/commits/ab25c5a2bdb010fc9ae68bdc0eb5a96dc461e46d","html_url":"https://github.com/chishm/core/commit/ab25c5a2bdb010fc9ae68bdc0eb5a96dc461e46d"}]}]